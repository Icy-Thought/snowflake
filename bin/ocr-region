#!/usr/bin/env cached-nix-shell
#! nix-shell -i bash -p tesseract imagemagick maim

# https://tesseract-ocr.github.io/tessdoc/Data-Files-in-different-versions.html
select tesseract_lang in eng swe ara chi_sim equ ;do break;done

SCR_IMG=`mktemp`
trap "rm $SCR_IMG*" EXIT

# increase image quality (-q) from 75 -> 100
maim -s $SCR_IMG.png -q 100

# Should increase detection rate
mogrify -modulate 100,0 -resize 400% $SCR_IMG.png

# Feed tesseract with the grabbed screenshot
tesseract $SCR_IMG.png $SCR_IMG &> /dev/null

# Finally, OCR output -> clipboard!
cat $SCR_IMG.txt | xclip -selection clipboard
